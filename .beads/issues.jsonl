{"id":"skillssupply-0xc","title":"sksup pkg remove command","description":"Remove package from ./skills.toml by alias. Error if alias not found. Use ink for output.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:18:18.882414-05:00","created_by":"alizain","updated_at":"2025-12-30T12:15:19.502218-05:00","closed_at":"2025-12-30T12:15:19.502218-05:00","close_reason":"Closed","labels":["commands","sksup"],"dependencies":[{"issue_id":"skillssupply-0xc","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:18:18.883453-05:00","created_by":"daemon"},{"issue_id":"skillssupply-0xc","depends_on_id":"skillssupply-5jr","type":"blocks","created_at":"2025-12-28T21:22:46.685623-05:00","created_by":"daemon"}],"comments":[{"id":3,"issue_id":"skillssupply-0xc","author":"alizain","text":"pkg remove now routed via sksup pkg remove; validated with local manifest update using pseudo-tty.","created_at":"2025-12-30T17:15:05Z"}]}
{"id":"skillssupply-160","title":"sksup sync command","description":"Orchestrate full sync flow: discover manifests, parse/merge, resolve packages, fetch, detect type, extract skills, install to enabled agents. Use ink for progress output.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:18:18.493891-05:00","created_by":"alizain","updated_at":"2025-12-30T12:03:35.12581-05:00","closed_at":"2025-12-30T12:03:35.12581-05:00","close_reason":"Closed","labels":["commands","sksup"],"dependencies":[{"issue_id":"skillssupply-160","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:18:18.494967-05:00","created_by":"daemon"},{"issue_id":"skillssupply-160","depends_on_id":"skillssupply-vsp","type":"blocks","created_at":"2025-12-28T21:22:42.111824-05:00","created_by":"daemon"},{"issue_id":"skillssupply-160","depends_on_id":"skillssupply-98v","type":"blocks","created_at":"2025-12-28T21:22:42.131987-05:00","created_by":"daemon"},{"issue_id":"skillssupply-160","depends_on_id":"skillssupply-3e6","type":"blocks","created_at":"2025-12-28T21:22:42.150675-05:00","created_by":"daemon"},{"issue_id":"skillssupply-160","depends_on_id":"skillssupply-pzy","type":"blocks","created_at":"2025-12-28T21:22:42.171511-05:00","created_by":"daemon"},{"issue_id":"skillssupply-160","depends_on_id":"skillssupply-n2f","type":"blocks","created_at":"2025-12-28T21:22:42.191657-05:00","created_by":"daemon"},{"issue_id":"skillssupply-160","depends_on_id":"skillssupply-jcy","type":"blocks","created_at":"2025-12-28T21:22:42.210952-05:00","created_by":"daemon"}],"comments":[{"id":1,"issue_id":"skillssupply-160","author":"alizain","text":"Implemented sync command via core/sync with clack prompts (ink removed per decision). Tested dry-run and install flows with local package.","created_at":"2025-12-30T17:03:20Z"}]}
{"id":"skillssupply-19a","title":"Implement Hono API: git smart-HTTP + repo generation + auth endpoints","description":"Create packages/api (@skills-supply/api) with Hono server: GET /me/:repo.git/info/refs and POST /me/:repo.git/git-upload-pack, token auth (Basic), repo_state caching, stub plugin generation, CLI auth endpoints (/auth/cli, /auth/cli/status). Use database package for persistence.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T10:14:21.037012-05:00","updated_at":"2025-12-19T13:44:58.058495-05:00","closed_at":"2025-12-19T13:44:58.058495-05:00","close_reason":"Closed via update","dependencies":[{"issue_id":"skillssupply-19a","depends_on_id":"skillssupply-yf2","type":"parent-child","created_at":"2025-12-19T10:14:44.004326-05:00","created_by":"daemon"}]}
{"id":"skillssupply-1ih","title":"Confirm docker-compose defaults (ports/db name/credentials)","description":"Validate desired Postgres docker-compose defaults and adjust docker-compose.yaml + database env expectations.","design":"**Decision: Docker-compose defaults (following cuttlefish convention)**\n\n```yaml\nservices:\n  postgres:\n    image: postgres:18\n    container_name: skillssupply_dev\n    environment:\n      POSTGRES_USER: postgres\n      POSTGRES_PASSWORD: postgres\n      POSTGRES_DB: skillssupply_dev\n    ports:\n      - \"5432:5432\"\n```\n\n**Convention:**\n- Container name: `{project}_dev`\n- User/password: `postgres`/`postgres` (local dev only)\n- DB name: `{project}_dev`\n- Standard port 5432","notes":"Decided 2025-12-19: Follow cuttlefish convention.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T12:09:08.481756-05:00","updated_at":"2025-12-19T12:57:40.725654-05:00","closed_at":"2025-12-19T12:57:40.725654-05:00","close_reason":"Decision made: Follow cuttlefish convention (skillssupply_dev, postgres/postgres, port 5432)","dependencies":[{"issue_id":"skillssupply-1ih","depends_on_id":"skillssupply-l2q","type":"discovered-from","created_at":"2025-12-19T12:09:13.422882-05:00","created_by":"daemon"}]}
{"id":"skillssupply-1xm","title":"Define pipeline types for sync stages","description":"Introduce explicit types for each pipeline stage (resolved manifest, fetched packages, detected packages, extracted packages) so dataflow is explicit and type-safe across sync.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T20:35:00.774781-05:00","created_by":"alizain","updated_at":"2025-12-30T12:02:27.86789-05:00","closed_at":"2025-12-30T12:02:27.86789-05:00","close_reason":"Closed","labels":["core-sync","sksup"],"dependencies":[{"issue_id":"skillssupply-1xm","depends_on_id":"skillssupply-160","type":"discovered-from","created_at":"2025-12-29T20:35:00.776582-05:00","created_by":"alizain"}]}
{"id":"skillssupply-1z3","title":"packages/core errors use plain string instead of branded types","description":"Error interfaces in packages/core use plain string for paths (e.g., skillPath: string in validateSkillName), while packages/sk uses branded types like AbsolutePath. This loses type safety guarantees that the rest of the codebase maintains.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T16:52:06.083283-05:00","created_by":"alizain","updated_at":"2026-01-03T16:52:06.083283-05:00","dependencies":[{"issue_id":"skillssupply-1z3","depends_on_id":"skillssupply-568","type":"blocks","created_at":"2026-01-03T16:52:34.655478-05:00","created_by":"alizain"}]}
{"id":"skillssupply-23s","title":"Discovery web integration","description":"Expose indexed_packages for the website (API/query layer + web integration) so discovery UI can consume the directory.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-03T09:40:42.370318-05:00","created_by":"alizain","updated_at":"2026-01-03T09:40:42.370318-05:00"}
{"id":"skillssupply-28w","title":"Integration tests: agent install","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T20:14:09.961205-05:00","created_by":"alizain","updated_at":"2025-12-30T20:45:16.801686-05:00","closed_at":"2025-12-30T20:45:16.801686-05:00","close_reason":"Closed","dependencies":[{"issue_id":"skillssupply-28w","depends_on_id":"skillssupply-a3i","type":"blocks","created_at":"2025-12-30T20:14:27.748975-05:00","created_by":"daemon"}]}
{"id":"skillssupply-2a9","title":"Integration tests: agent state","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T20:14:09.7033-05:00","created_by":"alizain","updated_at":"2025-12-30T20:45:16.800513-05:00","closed_at":"2025-12-30T20:45:16.800513-05:00","close_reason":"Closed","dependencies":[{"issue_id":"skillssupply-2a9","depends_on_id":"skillssupply-a3i","type":"blocks","created_at":"2025-12-30T20:14:27.556692-05:00","created_by":"daemon"}]}
{"id":"skillssupply-2fd","title":"Package type detection","description":"Detect package structure: skills.toml manifest, subdirs with SKILL.md, or single SKILL.md at root. Error if no recognizable structure.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:17:53.487375-05:00","created_by":"alizain","updated_at":"2025-12-29T19:58:30.2356-05:00","closed_at":"2025-12-29T19:58:30.2356-05:00","close_reason":"Added package type detection for manifest/plugin/subdir/root.","labels":["core-packages","sksup"],"dependencies":[{"issue_id":"skillssupply-2fd","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:17:53.48853-05:00","created_by":"daemon"},{"issue_id":"skillssupply-2fd","depends_on_id":"skillssupply-yzr","type":"blocks","created_at":"2025-12-28T21:22:05.93523-05:00","created_by":"daemon"}]}
{"id":"skillssupply-3br","title":"Document or hide auth/status/logout/whoami commands","status":"in_progress","priority":3,"issue_type":"task","created_at":"2026-01-02T11:05:58.174792-05:00","created_by":"alizain","updated_at":"2026-01-02T13:15:52.793433-05:00"}
{"id":"skillssupply-3e6","title":"Full reconciliation on sync","description":"Remove skills from agent paths that are not in manifest. Track installed skills to enable cleanup. Full reconciliation means installed state matches manifest exactly.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:18:05.656653-05:00","created_by":"alizain","updated_at":"2025-12-30T12:02:27.866214-05:00","closed_at":"2025-12-30T12:02:27.866214-05:00","close_reason":"Closed","labels":["core-agents","sksup"],"dependencies":[{"issue_id":"skillssupply-3e6","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:18:05.657638-05:00","created_by":"daemon"},{"issue_id":"skillssupply-3e6","depends_on_id":"skillssupply-8rz","type":"blocks","created_at":"2025-12-28T21:22:08.423086-05:00","created_by":"daemon"}]}
{"id":"skillssupply-3rn","title":"Add stage-tagged sync error wrapper","description":"Wrap module errors with a stage tag (discover/parse/merge/resolve/fetch/detect/extract/install) to unify CLI error reporting while preserving underlying details.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T20:35:30.717654-05:00","created_by":"alizain","updated_at":"2025-12-30T12:02:27.869347-05:00","closed_at":"2025-12-30T12:02:27.869347-05:00","close_reason":"Closed","labels":["core-sync","sksup"],"dependencies":[{"issue_id":"skillssupply-3rn","depends_on_id":"skillssupply-160","type":"discovered-from","created_at":"2025-12-29T20:35:30.719625-05:00","created_by":"alizain"}]}
{"id":"skillssupply-3xa","title":"Add @/ path alias to packages/api","description":"## Overview\nAdd `@/*` path alias to api package and convert all relative imports.\n\n## Changes\n\n### tsconfig.json\nAdd to compilerOptions:\n```json\n\"paths\": {\n  \"@/*\": [\"./*\"]\n}\n```\n\n### Convert imports\nAll `../env`, `../services/*`, `../utils/*` → `@/src/env`, `@/src/services/*`, `@/src/utils/*`\n\n## Files to update\n~10 files with relative imports\n\n## Why before src removal\nIDE will then convert `@/src/*` → `@/*` when files move.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-04T16:36:02.115204-05:00","created_by":"alizain","updated_at":"2026-01-04T16:43:00.8717-05:00","closed_at":"2026-01-04T16:43:00.8717-05:00","close_reason":"Added @/* path alias to tsconfig and converted all imports to @/src/... pattern"}
{"id":"skillssupply-41n","title":"Remove src/ directory nesting from packages/core","description":"## Overview\nFlatten `packages/core/src/` → `packages/core/`\n\n## Config Changes (YOU do these after IDE moves files)\n\n### tsconfig.json\n- `include`: `[\"src/**/*\"]` → `[\"**/*.ts\"]`\n\n### package.json\n- `exports.\".\":` `\"./src/index.ts\"` → `\"./index.ts\"`\n- `types`: `\"./src/index.ts\"` → `\"./index.ts\"`\n\n### vitest.config.ts\n- `include`: `[\"src/**/*.test.ts\"]` → `[\"**/*.test.ts\"]`\n\n## Import Changes (IDE handles)\n~15 files with `../types/*` → `./types/*` pattern adjustments\n\n## Files Moving\n- constants.ts, index.ts, frontmatter.test.ts, validation.test.ts\n- detection/, discovery/, manifest/, marketplace/, parsing/, types/, validation/\n\n## Verification\n- `npm run biome` passes\n- `npm test` in packages/core passes\n- `npm run build` from root passes","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T21:19:46.879204-05:00","created_by":"alizain","updated_at":"2026-01-04T16:31:01.006326-05:00","dependencies":[{"issue_id":"skillssupply-41n","depends_on_id":"skillssupply-9r6","type":"blocks","created_at":"2026-01-04T16:36:10.223381-05:00","created_by":"alizain"}]}
{"id":"skillssupply-453","title":"Confirm stub plugin.json schema and update generator","description":"Decide minimum plugin.json fields for stub plugins and adjust generator accordingly (manifest structure, version, commands).","design":"**Decision: Dynamic stub/full serving from single URL**\n\n**URL:** `skills.supply/u/:CREATOR_USERNAME/:PLUGIN_NAME.git`\n\n**Request flow:**\n1. User fetches via git (Basic auth with API token)\n2. Identify user from credentials, check purchase status\n3. Purchased → full version | Not purchased → stub version\n\n**Stub version (non-purchasers):**\n- Generated on-demand, short TTL cache\n- Valid plugin.json with version `0.0.0-stub`\n- `/buy` command that opens purchase page in browser\n- No freemium content for now (keep simple)\n\n**Full version (purchasers):**\n- Fetched from seller's GitHub on-demand, short TTL cache\n- May inject license validation, analytics, etc.\n\n**Stub plugin.json schema:**\n```json\n{\n  \"name\": \"plugin-name\",\n  \"version\": \"0.0.0-stub\",\n  \"description\": \"Premium plugin by @creator - purchase required\"\n}\n```\n\n**Stub commands/buy.md:**\nOpens `https://skills.supply/u/:creator/:plugin` purchase page","notes":"Decided 2025-12-19: Single URL serves stub vs full based on purchase status. No freemium for now.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T11:59:53.042926-05:00","updated_at":"2025-12-19T12:41:25.751529-05:00","closed_at":"2025-12-19T12:41:25.751529-05:00","close_reason":"Decision made: dynamic stub/full serving from single URL with /buy command in stub","dependencies":[{"issue_id":"skillssupply-453","depends_on_id":"skillssupply-19a","type":"discovered-from","created_at":"2025-12-19T11:59:58.758514-05:00","created_by":"daemon"}]}
{"id":"skillssupply-45q","title":"Set up bun build pipeline","description":"Add bundle script using bun build --compile. Test standalone binary works. Update package.json scripts.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:17:16.10922-05:00","created_by":"alizain","updated_at":"2025-12-28T21:39:52.090025-05:00","closed_at":"2025-12-28T21:39:52.090025-05:00","close_reason":"Closed","labels":["infrastructure","sksup"]}
{"id":"skillssupply-4aa","title":"sksup agent add/remove commands","description":"Enable/disable agents: sksup agent add claude-code, sksup agent remove codex. Write to [agents] section in ./skills.toml.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:18:25.799439-05:00","created_by":"alizain","updated_at":"2025-12-30T08:57:52.914512-05:00","closed_at":"2025-12-30T08:57:52.914512-05:00","close_reason":"Added agent add/remove commands that update skills.toml.","labels":["commands","sksup"],"dependencies":[{"issue_id":"skillssupply-4aa","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:18:25.800618-05:00","created_by":"daemon"},{"issue_id":"skillssupply-4aa","depends_on_id":"skillssupply-5jr","type":"blocks","created_at":"2025-12-28T21:22:48.976148-05:00","created_by":"daemon"},{"issue_id":"skillssupply-4aa","depends_on_id":"skillssupply-aik","type":"blocks","created_at":"2025-12-28T21:22:48.996903-05:00","created_by":"daemon"}]}
{"id":"skillssupply-4p4","title":"validateSkillName returns plain string instead of error object","description":"In packages/core/src/validation.ts:127, validateSkillName returns { ok: false; error: string } while all other functions in the codebase return { ok: false; error: { type, message, ... } }. This forces consumers (scan.ts:790, extract.ts:246) to use .error directly instead of .error.message, creating special-case handling.","status":"open","priority":1,"issue_type":"bug","created_at":"2026-01-03T16:52:05.55613-05:00","created_by":"alizain","updated_at":"2026-01-03T16:52:05.55613-05:00"}
{"id":"skillssupply-50i","title":"Remove src/ directory nesting from packages/sk","description":"## Overview\nFlatten `packages/sk/src/` → `packages/sk/`\n\n## Config Changes (YOU do these after IDE moves files)\n\n### tsconfig.json\n- `include`: `[\"src/**/*\", \"tests/**/*\"]` → `[\"**/*\"]` (or `[\"commands/**/*\", \"core/**/*\", ...]`)\n\n### package.json\n- `types`: `\"./src/index.d.ts\"` → `\"./index.d.ts\"`\n- `files`: Remove `\"src\"` from array\n- `build:binary`: `./src/cli.ts` → `./cli.ts`\n- `build:core`: `./src/index.ts` → `./index.ts`\n- `build:node`: `./src/cli.ts` → `./cli.ts`\n\n### vitest.config.ts\n- `include`: `[\"src/**/*.test.ts\", \"tests/**/*.test.ts\"]` → `[\"**/*.test.ts\"]`\n- `coverage.include`: `[\"src/**/*.ts\"]` → `[\"**/*.ts\"]` (exclude node_modules, dist, tests)\n- `coverage.exclude`: `[\"src/**/*.test.ts\"]` → `[\"**/*.test.ts\"]`\n\n## Import Changes (IDE handles)\n49+ files with `@/src/*` → `@/*` pattern\n\n## Files Moving\n- cli.ts, index.ts, index.d.ts, env.ts\n- commands/, core/, credentials/, utils/\n\n## In-Source Tests (4 files)\n- src/commands/sync.test.ts\n- src/core/manifest/parse.test.ts\n- src/core/packages/resolve.test.ts\n- src/core/packages/auto-detect.test.ts\n\n## Verification\n- `npm run biome` passes\n- `npm test` in packages/sk passes\n- `npm run build` from root passes\n- `npm run build:binary` produces working bin/sk","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T21:19:47.152619-05:00","created_by":"alizain","updated_at":"2026-01-04T16:31:01.730278-05:00"}
{"id":"skillssupply-53i","title":"Refactor sk sync pipeline + marketplace resolution","description":"Context\n- `packages/sk/src/core/sync/sync.ts` mixes marketplace/Claude plugin validation + resolution with standard fetch/extract/install, which makes the dataflow hard to review.\n- `mergeManifests` dedupes identical canonical deps under different aliases silently; we want warnings surfaced in `sk sync` output.\n\nGoal\n- Make sync orchestration read linearly with explicit staged data structures.\n- Isolate marketplace/plugin resolution from the core pipeline.\n- Emit dedupe warnings without changing functional behavior (still dedupe).\n\nDataflow baseline (current behavior to preserve)\n- discover -\u003e parse -\u003e merge -\u003e resolve deps -\u003e select agents -\u003e per-agent plugin handling -\u003e fetch -\u003e detect -\u003e extract -\u003e validate -\u003e plan -\u003e install -\u003e reconcile -\u003e state\n\nPlan (high level)\n1) Add a structured warning channel for deduped dependencies in `mergeManifests` and propagate it via `SyncSummary.warnings` to `packages/sk/src/commands/sync.ts`.\n2) Extract marketplace + Claude plugin parsing/validation/resolution into a dedicated module (e.g. `packages/sk/src/core/sync/marketplace.ts`), leaving `sync.ts` to orchestrate and assemble stages.\n3) Introduce explicit stage data types (e.g. `ResolvedPackages`, `FetchedPackages`, `ExtractedPackages`) so `syncAgent` operates on typed inputs without branching on implicit state.\n4) Keep transformations at boundaries; core stage functions should assume typed inputs and return typed outputs.\n5) Add focused tests around merge warnings and plugin source parsing if test infra is available (otherwise outline a follow-up).\n\nTouch points\n- `packages/sk/src/core/sync/sync.ts`\n- `packages/sk/src/core/sync/types.ts`\n- `packages/sk/src/core/manifest/merge.ts`\n- new: `packages/sk/src/core/sync/marketplace.ts` (or `packages/sk/src/core/marketplace/*`)\n- `packages/sk/src/commands/sync.ts`\n\nAcceptance\n- `sk sync` prints warnings when distinct aliases resolve to the same canonical package; warning includes alias + source manifest path(s).\n- Marketplace/plugin logic is moved out of `sync.ts`; `sync.ts` reads as a linear pipeline with minimal branching.\n- No behavior regressions; existing output unchanged aside from new warnings.\n","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-30T18:06:17.757107-05:00","created_by":"alizain","updated_at":"2025-12-30T18:37:08.814356-05:00","closed_at":"2025-12-30T18:37:08.814356-05:00","close_reason":"Closed"}
{"id":"skillssupply-546","title":"Prompt for agent selection when no agents configured during sync","description":"Change default behavior:\n- No agents enabled by default\n- During sync (or pkg add --sync), if no agents are configured, prompt user with multi-select to enable agents\n- Implement as reusable check-and-prompt that works for both:\n  - `sk sync` command\n  - `sk pkg add --sync` command (after manifest update, before sync runs)\n\nThis ensures users explicitly choose which agents to enable rather than having defaults.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-30T23:54:59.758423-05:00","created_by":"alizain","updated_at":"2025-12-30T23:54:59.758423-05:00","dependencies":[{"issue_id":"skillssupply-546","depends_on_id":"skillssupply-7ot","type":"blocks","created_at":"2025-12-30T23:55:05.250153-05:00","created_by":"daemon"}]}
{"id":"skillssupply-568","title":"PackageValidationError missing type discriminator field","description":"In packages/core/src/validation.ts:34-37, PackageValidationError only has { field, message } but no type field. All error types in packages/sk have a discriminated type field for programmatic error handling. Should add type: PackageValidationErrorType for consistency.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T16:52:06.653468-05:00","created_by":"alizain","updated_at":"2026-01-03T16:52:06.653468-05:00"}
{"id":"skillssupply-5ib","title":"Add --global flag to pkg add/remove for ~/.sk/agents.toml","description":"Support global skill installation with two distinct behaviors:\n\n1. **Per-project global**: Skills from ~/.sk/agents.toml get installed into each PROJECT_DIR/.claude/skills (copied to every project)\n\n2. **User-level global**: Skills from ~/.sk/agents.toml get installed once into HOME_DIR/.claude/skills (shared across all projects)\n\nNeed to determine:\n- How to distinguish between these two modes (flag? separate config sections?)\n- Whether both modes should coexist or be mutually exclusive\n- How Claude Code/Codex currently handles this distinction","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-30T23:50:56.9744-05:00","created_by":"alizain","updated_at":"2025-12-31T14:27:07.021152-05:00"}
{"id":"skillssupply-5jr","title":"TOML parsing with smol-toml","description":"Parse skills.toml files using smol-toml. Validate structure matches expected schema. Return typed Manifest objects.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:17:33.660364-05:00","created_by":"alizain","updated_at":"2025-12-29T10:51:23.551889-05:00","closed_at":"2025-12-29T10:51:23.551889-05:00","close_reason":"Closed","labels":["core-manifest","sksup"],"dependencies":[{"issue_id":"skillssupply-5jr","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:17:33.661637-05:00","created_by":"daemon"},{"issue_id":"skillssupply-5jr","depends_on_id":"skillssupply-yzr","type":"blocks","created_at":"2025-12-28T21:21:58.922218-05:00","created_by":"daemon"}]}
{"id":"skillssupply-5qf","title":"Fix: Discovery should explicitly skip plugin-only repos","description":"## Problem\nSPEC.md says:\n\n\u003e **plugin.json only (no marketplace.json):**\n\u003e - **Action**: SKIP — do not index\n\u003e - **Rationale**: This plugin exists in a marketplace somewhere. Indexing it here would create duplicates.\n\nDiscovery's scanRepo currently works correctly by accident:\n- Phase 1 only checks marketplace + manifest (not plugin alone)\n- Plugin-only repos fall through to Phase 2\n- Phase 2 finds skills, not the plugin itself\n\n## Current Behavior\nWorks correctly but **implicit**. A future change could break this.\n\n## Expected Behavior\nAdd explicit check and skip with clear comment:\n\n```typescript\n// SPEC: Skip plugin-only repos (no marketplace.json)\n// These plugins exist in a marketplace elsewhere - indexing here creates duplicates\nif (hasPluginJson \u0026\u0026 !hasMarketplaceJson) {\n  // Continue to Phase 2 for skills, but don't index as plugin\n}\n```\n\n## Files\n- packages/discovery/src/detection/scan.ts\n- packages/SPEC.md (What Gets SKIPPED section)","status":"open","priority":3,"issue_type":"bug","created_at":"2026-01-04T11:59:25.721131-05:00","created_by":"alizain","updated_at":"2026-01-04T11:59:25.721131-05:00"}
{"id":"skillssupply-5r5","title":"Replace ink with clack for CLI prompts","description":"Use @clack/prompts instead of ink for CLI interactions. Clack is lighter weight and better suited for our needs. Update all commands to use clack for spinners, confirmations, and select prompts.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T10:57:56.175533-05:00","created_by":"alizain","updated_at":"2025-12-30T09:17:18.812059-05:00","closed_at":"2025-12-30T09:17:18.812059-05:00","close_reason":"Replaced Ink/React with @clack/prompts and migrated commands to .ts.","labels":["infrastructure","sksup"]}
{"id":"skillssupply-63l","title":"Migrate sksup CLI from cac to commander 14.0.2","description":"Switch sksup CLI parsing to Commander.js (v14.0.2) with nested subcommands for pkg/agent, remove manual dispatch logic, update help/usage, replace cac dependency, and validate CLI commands.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T15:28:04.231168-05:00","created_by":"alizain","updated_at":"2025-12-31T08:54:54.862207-05:00","closed_at":"2025-12-31T08:54:54.862207-05:00","close_reason":"Already complete - commander@14.0.2 is active CLI framework, no cac imports remain"}
{"id":"skillssupply-642","title":"Review CLI auth handshake flow for security implications","description":"Review the CLI authentication handshake flow for security implications before implementation.\n\nCurrent proposed flow:\n1. CLI calls POST /auth/cli → gets session_id\n2. CLI opens browser to https://skills.supply/auth/cli?session=...\n3. User logs in via browser\n4. CLI polls GET /auth/cli/status?session=... until it gets token\n5. CLI stores token using OS credential helper\n\nQuestions to review:\n- Is session_id sufficiently random/unguessable?\n- Should /auth/cli/status require any auth or is session_id enough?\n- Rate limiting on polling endpoint?\n- Should session be single-use after token issued?\n- Any CSRF/redirect concerns on browser side?","design":"**Decision: Doppler-style Device Flow**\n\n## Flow Summary\n\n1. `POST /auth/cli` → returns `device_code` (secret) + `user_code` (human-readable)\n2. CLI displays code, copies to clipboard, opens browser to `/auth/cli`\n3. User pastes code in browser, clicks Authorize\n4. CLI polls `POST /auth/cli/token` with `device_code`\n5. Server returns token, CLI stores in OS keychain\n\n## User Code Format\n\n- **Length:** 12 characters\n- **Format:** `XXXX-XXXX-XXXX`\n- **Charset:** `BCDFGHJKMNPQRSTVWXYZ` (20 consonants, no vowels, no confusing chars)\n- **Entropy:** 20^12 ≈ 4 trillion combinations\n\n## API Endpoints\n\n**POST /auth/cli** (no auth)\n- Creates session\n- Returns: `{ device_code, user_code, verification_url, expires_in, interval }`\n- Rate limit: 5/min per IP\n\n**GET /auth/cli** (no auth)\n- Browser auth page, user enters code\n\n**POST /auth/cli/verify** (web session required)\n- Body: `{ user_code }`\n- Links user to session, marks authenticated\n\n**POST /auth/cli/token** (no auth)\n- Body: `{ device_code }`\n- Returns: `{ status: \"pending\" | \"success\" | \"expired\", token?, user_id?, username?, email? }`\n- Rate limit: 1/5s per device_code\n\n## Response Statuses\n\n| Status | Meaning |\n|--------|---------|\n| `pending` | User hasn't completed auth yet |\n| `success` | Token issued |\n| `expired` | Session timed out |\n\n## Security Properties\n\n- No session info in URLs\n- `device_code` is 256-bit secret, never exposed\n- `user_code` is human-verified binding\n- Single-use sessions\n- 10 min expiry\n- Rate limited polling\n\n## Database: cli_auth_sessions\n\n```sql\nCREATE TABLE cli_auth_sessions (\n  id UUID PRIMARY KEY,\n  device_code TEXT NOT NULL UNIQUE,  -- 256-bit hex\n  user_code TEXT NOT NULL UNIQUE,    -- XXXX-XXXX-XXXX\n  status TEXT NOT NULL DEFAULT 'pending',\n  user_id UUID REFERENCES users(id),\n  expires_at TIMESTAMPTZ NOT NULL,\n  created_at TIMESTAMPTZ DEFAULT NOW(),\n  authenticated_at TIMESTAMPTZ,\n  consumed_at TIMESTAMPTZ,\n  ip_address INET,\n  user_agent TEXT\n);\n```","notes":"Decided 2025-12-19: Doppler-style device flow with 12-char user code, no slow_down status.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T12:53:36.314164-05:00","updated_at":"2025-12-19T13:22:13.931676-05:00","closed_at":"2025-12-19T13:22:13.931676-05:00","close_reason":"Decision made: Doppler-style device flow with user_code (12 chars) + device_code, no URL exposure","dependencies":[{"issue_id":"skillssupply-642","depends_on_id":"skillssupply-qz1","type":"discovered-from","created_at":"2025-12-19T12:53:36.314992-05:00","created_by":"daemon"}]}
{"id":"skillssupply-6xi","title":"Integration tests: manifest discovery","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T20:14:09.470052-05:00","created_by":"alizain","updated_at":"2025-12-30T20:45:16.799262-05:00","closed_at":"2025-12-30T20:45:16.799262-05:00","close_reason":"Closed","dependencies":[{"issue_id":"skillssupply-6xi","depends_on_id":"skillssupply-a3i","type":"blocks","created_at":"2025-12-30T20:14:27.358411-05:00","created_by":"daemon"}]}
{"id":"skillssupply-712","title":"Spike: Unified slash command format for Claude Code + Codex CLI","description":"Investigate creating a common skill/command format that works across both Claude Code and Codex CLI.\n\n**Key findings from initial research:**\n- Both use Markdown + YAML frontmatter\n- Common: description, argument-hint, $1-$9, $ARGUMENTS, $$\n- Claude-only: allowed-tools, model, !`bash`, @file refs\n- Codex-only: named placeholders ($FILE, $TICKET_ID)\n- Different locations: .claude/commands/ vs ~/.codex/prompts/\n\n**Potential approach:**\n1. Define superset format in sksup\n2. Parse once, transform for each target\n3. Install to both agent command directories\n\nDocs:\n- https://code.claude.com/docs/en/slash-commands#custom-slash-commands\n- https://developers.openai.com/codex/cli/slash-commands","status":"open","priority":4,"issue_type":"feature","created_at":"2025-12-29T20:20:46.689883-05:00","created_by":"alizain","updated_at":"2025-12-29T20:21:00.733167-05:00"}
{"id":"skillssupply-7di","title":"Align packages/core error handling to packages/sk patterns","description":"packages/core has demonstrably less mature error handling than packages/sk. This epic tracks aligning the error shapes, adding readonly modifiers, using branded types, and ensuring consistent discriminated unions across the shared foundation package.","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-03T16:52:24.536251-05:00","created_by":"alizain","updated_at":"2026-01-03T16:52:24.536251-05:00","dependencies":[{"issue_id":"skillssupply-7di","depends_on_id":"skillssupply-4p4","type":"blocks","created_at":"2026-01-03T16:52:34.113981-05:00","created_by":"alizain"},{"issue_id":"skillssupply-7di","depends_on_id":"skillssupply-8ln","type":"blocks","created_at":"2026-01-03T16:52:34.178831-05:00","created_by":"alizain"},{"issue_id":"skillssupply-7di","depends_on_id":"skillssupply-1z3","type":"blocks","created_at":"2026-01-03T16:52:34.242585-05:00","created_by":"alizain"},{"issue_id":"skillssupply-7di","depends_on_id":"skillssupply-eq7","type":"blocks","created_at":"2026-01-03T16:52:34.3062-05:00","created_by":"alizain"},{"issue_id":"skillssupply-7di","depends_on_id":"skillssupply-568","type":"blocks","created_at":"2026-01-03T16:52:34.369902-05:00","created_by":"alizain"},{"issue_id":"skillssupply-7di","depends_on_id":"skillssupply-8z2","type":"blocks","created_at":"2026-01-03T16:52:34.433657-05:00","created_by":"alizain"}]}
{"id":"skillssupply-7k2","title":"Add pipeline invariant validation between stages","description":"Centralize checks between stages (e.g., fetched package path exists, extracted skills non-empty) to ensure fail-fast semantics with consistent errors.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T20:35:59.555152-05:00","created_by":"alizain","updated_at":"2025-12-30T12:02:27.870661-05:00","closed_at":"2025-12-30T12:02:27.870661-05:00","close_reason":"Closed","labels":["core-sync","sksup"],"dependencies":[{"issue_id":"skillssupply-7k2","depends_on_id":"skillssupply-160","type":"discovered-from","created_at":"2025-12-29T20:35:59.557424-05:00","created_by":"alizain"}]}
{"id":"skillssupply-7lp","title":"Discovery draft uses versionless registry install, but sk pkg add registry requires name@version","description":"Discovery draft template uses 'sk pkg add registry name' but sk currently requires name@version; decide whether to relax CLI parsing or adjust template for registry installs.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T21:29:31.653294-05:00","created_by":"alizain","updated_at":"2026-01-02T21:30:02.735633-05:00"}
{"id":"skillssupply-7mg","title":"Fix shared build errors in next-config-base","description":"tsc --build fails in @skills-supply/shared: missing webpack types and implicit any in src/next-config-base.ts. Resolve webpack typings and type the rule param.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T09:09:38.420901-05:00","created_by":"alizain","updated_at":"2025-12-30T09:31:41.925263-05:00","closed_at":"2025-12-30T09:31:41.925263-05:00","close_reason":"Deleted @skills-supply/shared package. Moved next-config-base.ts to packages/web/lib/next-config.ts (with inlined webpack types) and fontawesome.tsx to packages/web/components/FontAwesomeIcon.tsx. Both files are now local to the only consumer (web package).","labels":["build","shared"],"dependencies":[{"issue_id":"skillssupply-7mg","depends_on_id":"skillssupply-45q","type":"discovered-from","created_at":"2025-12-29T09:09:38.423266-05:00","created_by":"alizain"}]}
{"id":"skillssupply-7ot","title":"Add --sync flag to pkg add/remove commands","description":"Add a --sync flag that automatically runs sync after the manifest has been updated","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-30T23:46:58.96586-05:00","created_by":"alizain","updated_at":"2025-12-30T23:46:58.96586-05:00"}
{"id":"skillssupply-7st","title":"Centralize core IO helpers with consistent error shapes","description":"Consolidate safeStat/ensureDir/readDir/runGit helpers into shared core utilities to enforce consistent error reporting and reduce duplication.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T20:35:16.298877-05:00","created_by":"alizain","updated_at":"2025-12-30T12:02:27.868649-05:00","closed_at":"2025-12-30T12:02:27.868649-05:00","close_reason":"Closed","labels":["core-utils","sksup"],"dependencies":[{"issue_id":"skillssupply-7st","depends_on_id":"skillssupply-160","type":"discovered-from","created_at":"2025-12-29T20:35:16.300647-05:00","created_by":"alizain"}]}
{"id":"skillssupply-8ln","title":"packages/core errors missing readonly modifiers","description":"Error interfaces in packages/core (PackageValidationError, FrontmatterError) don't use readonly modifiers, unlike packages/sk which consistently uses readonly on all error interface fields. This is a code quality inconsistency that should be aligned.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T16:52:05.821908-05:00","created_by":"alizain","updated_at":"2026-01-03T16:52:05.821908-05:00"}
{"id":"skillssupply-8rz","title":"Agent installation","description":"Copy skills to agent paths with prefixed names (e.g., superpowers-brainstorming). Create directories if needed. Handle symlinks for local path packages.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:18:05.462055-05:00","created_by":"alizain","updated_at":"2025-12-29T20:41:52.670701-05:00","closed_at":"2025-12-29T20:41:52.670701-05:00","close_reason":"Implemented agent installation with copy/symlink handling.","labels":["core-agents","sksup"],"dependencies":[{"issue_id":"skillssupply-8rz","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:18:05.463149-05:00","created_by":"daemon"},{"issue_id":"skillssupply-8rz","depends_on_id":"skillssupply-aik","type":"blocks","created_at":"2025-12-28T21:22:08.404206-05:00","created_by":"daemon"}]}
{"id":"skillssupply-8ye","title":"Remove src/ directory nesting from packages/api","description":"## Overview\nFlatten `packages/api/src/` → `packages/api/`\n\n## Config Changes (YOU do these after IDE moves files)\n\n### tsconfig.json\n- `rootDir`: `\"./src\"` → `\".\"`\n- `include`: `[\"src/**/*\"]` → `[\"**/*.ts\"]`\n\n### package.json\n- No changes needed (already points to dist/)\n\n## Import Changes (IDE handles)\n~10 files with relative path adjustments\n\n## Files Moving\n- index.ts, env.ts\n- routes/, services/, utils/\n\n## Verification\n- `npm run biome` passes\n- `npm run build` from root passes","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-04T16:23:54.248403-05:00","created_by":"alizain","updated_at":"2026-01-04T16:31:01.248868-05:00","dependencies":[{"issue_id":"skillssupply-8ye","depends_on_id":"skillssupply-3xa","type":"blocks","created_at":"2026-01-04T16:36:10.251804-05:00","created_by":"alizain"}]}
{"id":"skillssupply-8z2","title":"CoercionError uses 'reason' instead of 'message' field","description":"In packages/sk/src/core/types/coerce.ts:251-255, CoercionError uses { field, value, reason } while every other error type in the codebase uses 'message'. This inconsistency means error handlers need special-case logic. Should rename reason to message for uniformity.","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-03T16:52:06.961991-05:00","created_by":"alizain","updated_at":"2026-01-03T16:52:06.961991-05:00"}
{"id":"skillssupply-91c","title":"Vitest setup for sk","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-30T20:14:07.997179-05:00","created_by":"alizain","updated_at":"2025-12-30T20:19:31.27679-05:00","closed_at":"2025-12-30T20:19:31.27679-05:00","close_reason":"Closed"}
{"id":"skillssupply-98v","title":"Skill extraction from packages","description":"Find SKILL.md files within packages. Parse YAML frontmatter for skill name. Return list of Skill objects with name and source path.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:18:05.069339-05:00","created_by":"alizain","updated_at":"2025-12-29T20:09:58.416799-05:00","closed_at":"2025-12-29T20:09:58.416799-05:00","close_reason":"Implemented SKILL.md extraction with frontmatter parsing.","labels":["core-packages","sksup"],"dependencies":[{"issue_id":"skillssupply-98v","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:18:05.070409-05:00","created_by":"daemon"},{"issue_id":"skillssupply-98v","depends_on_id":"skillssupply-2fd","type":"blocks","created_at":"2025-12-28T21:22:05.9546-05:00","created_by":"daemon"}]}
{"id":"skillssupply-9bb","title":"Normalize prompt cancellations in manifest selection and marketplace plugin flow","description":"Prompt cancellations in packages/sk/src/commands/manifest-selection.ts and packages/sk/src/commands/pkg/add.ts (selectMarketplacePlugin) still throw \"Canceled.\" and bubble up as failures. Consider translating these to CommandResult.cancelled or explicit cancellation results so top-level commands can print Canceled. instead of Failed.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-02T13:34:24.695302-05:00","created_by":"alizain","updated_at":"2026-01-02T14:03:52.681386-05:00","closed_at":"2026-01-02T14:03:52.681386-05:00","close_reason":"Normalized prompt cancellations to return CommandResult.cancelled and updated call sites."}
{"id":"skillssupply-9f3","title":"Extract shared git ref+path validation in adaptDependency","description":"## Context\n\nIn `packages/core/src/manifest/adapter.ts`, the `adaptDependency` function has a switch with 5 cases. The `github` and `git` cases share ~15 lines of identical ref+path validation:\n\n```typescript\n// Lines ~186-210 (github) and ~211-244 (git) both do:\nconst refResult = adaptGitRef(rawDep, manifestPath)\nif (!refResult.ok) return refResult\nconst pathResult = adaptOptionalPath(rawDep.path, manifestPath)  \nif (!pathResult.ok) return pathResult\n// ... then build declaration with ref and path\n```\n\n## Task\n\nExtract a helper function:\n```typescript\nfunction adaptGitSourceFields(\n  rawDep: { tag?: string; branch?: string; rev?: string; path?: string },\n  manifestPath: AbsolutePath\n): Result\u003c{ ref?: GitRef; path?: NonEmptyString }\u003e\n```\n\nCall from both `github` and `git` cases.\n\n## Files\n- packages/core/src/manifest/adapter.ts","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-04T12:24:28.904334-05:00","created_by":"alizain","updated_at":"2026-01-04T12:24:28.904334-05:00"}
{"id":"skillssupply-9gq","title":"Discovery GitHub source","description":"Add a GitHub search-based discovery source (SKILL.md/agents.toml queries) as an alternative to SkillsMP.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-03T09:40:57.004604-05:00","created_by":"alizain","updated_at":"2026-01-03T09:40:57.004604-05:00"}
{"id":"skillssupply-9ik","title":"Discovery enqueue fails on SkillsMP 429; add backoff or resume handling","description":"SkillsMP search hits 429 around page 20; enqueue exits early. Add retry/backoff and resume strategy so full crawl completes.\n","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T08:53:40.668343-05:00","created_by":"alizain","updated_at":"2026-01-03T08:54:24.4205-05:00"}
{"id":"skillssupply-9ko","title":"Unit tests: packages/resolve.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T20:14:08.991021-05:00","created_by":"alizain","updated_at":"2025-12-30T20:45:16.796955-05:00","closed_at":"2025-12-30T20:45:16.796955-05:00","close_reason":"Closed","dependencies":[{"issue_id":"skillssupply-9ko","depends_on_id":"skillssupply-a3i","type":"blocks","created_at":"2025-12-30T20:14:26.986118-05:00","created_by":"daemon"}]}
{"id":"skillssupply-9ly","title":"Unit tests: manifest/merge.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T20:14:08.785492-05:00","created_by":"alizain","updated_at":"2025-12-30T20:45:16.795666-05:00","closed_at":"2025-12-30T20:45:16.795666-05:00","close_reason":"Closed","dependencies":[{"issue_id":"skillssupply-9ly","depends_on_id":"skillssupply-a3i","type":"blocks","created_at":"2025-12-30T20:14:26.788307-05:00","created_by":"daemon"}]}
{"id":"skillssupply-9r6","title":"Add @/ path alias to packages/core","description":"## Overview\nAdd `@/*` path alias to core package and convert all relative imports.\n\n## Changes\n\n### tsconfig.json\nAdd to compilerOptions:\n```json\n\"paths\": {\n  \"@/*\": [\"./*\"]\n}\n```\n\n### Convert imports\nAll `../types/*`, `../manifest/*`, etc. → `@/src/types/*`, `@/src/manifest/*`\n\n## Files to update\n~15 files with relative imports\n\n## Why before src removal\nIDE will then convert `@/src/*` → `@/*` when files move.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-04T16:36:01.908394-05:00","created_by":"alizain","updated_at":"2026-01-04T16:43:00.869093-05:00","closed_at":"2026-01-04T16:43:00.869093-05:00","close_reason":"Added @/* path alias to tsconfig and converted all imports to @/src/... pattern"}
{"id":"skillssupply-9uw","title":"Confirm sksup base URL configuration default","description":"Confirm SKSUP_BASE_URL default and override behavior; update CLI config/messages as needed.","design":"**Decision: sksup base URL configuration**\n\n**Default:**\n- `https://api.skills.supply` (production)\n\n**Override:**\n- `SKSUP_BASE_URL` env var\n\n**Implementation:**\n- Use `packages/sksup/src/env.ts` for configuration\n- Bun compiles this into the binary\n- Env var checked at runtime for override\n\n```typescript\n// packages/sksup/src/env.ts\nexport const SKSUP_BASE_URL = process.env.SKSUP_BASE_URL ?? \"https://api.skills.supply\";\n```","notes":"Decided 2025-12-19: Default to api.skills.supply, override via SKSUP_BASE_URL, use env.ts for bun compile.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T12:09:18.749735-05:00","updated_at":"2025-12-19T12:59:12.993218-05:00","closed_at":"2025-12-19T12:59:12.993218-05:00","close_reason":"Decision made: Default https://api.skills.supply, override via SKSUP_BASE_URL, config in env.ts for bun compile","dependencies":[{"issue_id":"skillssupply-9uw","depends_on_id":"skillssupply-wy2","type":"discovered-from","created_at":"2025-12-19T12:09:22.827054-05:00","created_by":"daemon"}]}
{"id":"skillssupply-a3i","title":"Test helpers (withTempDir, builders, assertions)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-30T20:14:08.193714-05:00","created_by":"alizain","updated_at":"2025-12-30T20:42:23.377411-05:00","closed_at":"2025-12-30T20:42:23.377411-05:00","close_reason":"Closed","dependencies":[{"issue_id":"skillssupply-a3i","depends_on_id":"skillssupply-91c","type":"blocks","created_at":"2025-12-30T20:14:26.219923-05:00","created_by":"daemon"}]}
{"id":"skillssupply-aik","title":"Agent registry","description":"Define agents with id, displayName, skillsPath, detect function. Support Claude Code (~/.claude/skills/), Codex (~/.codex/skills/), OpenCode (~/.config/opencode/skill/).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:18:05.266887-05:00","created_by":"alizain","updated_at":"2025-12-29T20:16:51.974497-05:00","closed_at":"2025-12-29T20:16:51.974497-05:00","close_reason":"Defined agent registry with detection paths and skill locations.","labels":["core-agents","sksup"],"dependencies":[{"issue_id":"skillssupply-aik","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:18:05.267831-05:00","created_by":"daemon"},{"issue_id":"skillssupply-aik","depends_on_id":"skillssupply-yzr","type":"blocks","created_at":"2025-12-28T21:22:08.383185-05:00","created_by":"daemon"}]}
{"id":"skillssupply-alg","title":"Unit tests: types/branded.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T20:14:09.243088-05:00","created_by":"alizain","updated_at":"2025-12-30T20:45:16.798118-05:00","closed_at":"2025-12-30T20:45:16.798118-05:00","close_reason":"Closed","dependencies":[{"issue_id":"skillssupply-alg","depends_on_id":"skillssupply-a3i","type":"blocks","created_at":"2025-12-30T20:14:27.172057-05:00","created_by":"daemon"}]}
{"id":"skillssupply-bhk","title":"Preserve SSH URLs - don't normalize to HTTPS","description":"coerceGitUrl() in packages/sk/src/core/types/coerce.ts converts SSH URLs (git@host:path) to HTTPS (https://host/path). This is a one-way transformation that loses the original format. SSH URLs should be preserved as-is for users who need SSH authentication.","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-01T08:41:07.838331-05:00","created_by":"alizain","updated_at":"2026-01-01T08:41:07.838331-05:00"}
{"id":"skillssupply-cht","title":"Sparse checkout for monorepo package paths","description":"When a package declaration includes a subdirectory path, use git sparse checkout (or equivalent) for github/git fetches instead of full clones.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T19:59:27.701155-05:00","created_by":"alizain","updated_at":"2025-12-29T20:22:58.09479-05:00","closed_at":"2025-12-29T20:22:58.09479-05:00","close_reason":"Added sparse checkout for monorepo package paths.","labels":["core-packages","sksup"],"dependencies":[{"issue_id":"skillssupply-cht","depends_on_id":"skillssupply-pzy","type":"discovered-from","created_at":"2025-12-29T19:59:27.703254-05:00","created_by":"alizain"}]}
{"id":"skillssupply-d9u","title":"sksup agent interactive mode","description":"Ink-based agent toggle UI. Show all supported agents with checkboxes. Triggered by bare 'sksup agent' command.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:18:25.981487-05:00","created_by":"alizain","updated_at":"2025-12-30T15:12:53.083837-05:00","closed_at":"2025-12-30T15:12:53.083837-05:00","close_reason":"Closed","labels":["commands","sksup"],"dependencies":[{"issue_id":"skillssupply-d9u","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:18:25.982552-05:00","created_by":"daemon"},{"issue_id":"skillssupply-d9u","depends_on_id":"skillssupply-4aa","type":"blocks","created_at":"2025-12-28T21:22:49.018365-05:00","created_by":"daemon"}],"comments":[{"id":4,"issue_id":"skillssupply-d9u","author":"alizain","text":"Agent interactive exists; unable to complete multiselect in non-interactive run (TTY input required). Needs manual validation.","created_at":"2025-12-30T17:15:34Z"},{"id":7,"issue_id":"skillssupply-d9u","author":"alizain","text":"Validated agent interactive via pseudo-tty: selection prompt renders; submitting default selection completes with 'No agent changes needed'. Attempting to deselect all shows 'select at least one option' constraint.","created_at":"2025-12-30T20:12:39Z"}]}
{"id":"skillssupply-db8","title":"Rename sksup CLI to sk","description":"Rename sksup CLI package/binary to sk. Update package name, bin entry, CLI strings, and any config paths or user-facing references; ensure build outputs and docs align.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T15:54:50.776112-05:00","created_by":"alizain","updated_at":"2025-12-31T08:54:54.493082-05:00","closed_at":"2025-12-31T08:54:54.493082-05:00","close_reason":"Duplicate of ivd - CLI already renamed to sk"}
{"id":"skillssupply-dpj","title":"Remove src/ directory nesting from all packages","description":"## Goal\nRemove src/ directory nesting from core, api, discovery, sk packages.\n\n## Execution Order\n\n### Phase 1: Add path aliases (pre-work)\n1. skillssupply-9r6 - Add @/ alias to core, convert relative imports\n2. skillssupply-3xa - Add @/ alias to api, convert relative imports\n\n### Phase 2: Remove src/ nesting\n3. skillssupply-41n - core (foundation)\n4. skillssupply-8ye - api (simplest)\n5. skillssupply-j4k - discovery\n6. skillssupply-50i - sk (most complex)\n\n## Workflow\n1. Claude adds path alias, converts relative imports to @/src/...\n2. Human moves files with IDE (auto-updates to @/...)\n3. Claude updates configs\n4. Verify: biome, tests, build","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-04T16:24:38.443624-05:00","created_by":"alizain","updated_at":"2026-01-04T16:36:43.574373-05:00","dependencies":[{"issue_id":"skillssupply-dpj","depends_on_id":"skillssupply-41n","type":"blocks","created_at":"2026-01-04T16:24:46.266802-05:00","created_by":"alizain"},{"issue_id":"skillssupply-dpj","depends_on_id":"skillssupply-j4k","type":"blocks","created_at":"2026-01-04T16:24:46.298201-05:00","created_by":"alizain"},{"issue_id":"skillssupply-dpj","depends_on_id":"skillssupply-50i","type":"blocks","created_at":"2026-01-04T16:24:46.330286-05:00","created_by":"alizain"},{"issue_id":"skillssupply-dpj","depends_on_id":"skillssupply-8ye","type":"blocks","created_at":"2026-01-04T16:24:46.360187-05:00","created_by":"alizain"},{"issue_id":"skillssupply-dpj","depends_on_id":"skillssupply-9r6","type":"blocks","created_at":"2026-01-04T16:36:10.423262-05:00","created_by":"alizain"},{"issue_id":"skillssupply-dpj","depends_on_id":"skillssupply-3xa","type":"blocks","created_at":"2026-01-04T16:36:10.451473-05:00","created_by":"alizain"}]}
{"id":"skillssupply-e0u","title":"Remove src/ directory nesting from packages/database","description":"## Overview\n\nAudit and flatten `packages/database/` if it has a `src/` layer.\n\n## Pre-Work: Understand Implications (REQUIRED)\n\n**Before making any changes**, use subagents to:\n\n1. **Verify structure** - Check if `src/` exists and what it contains\n2. **Audit configuration** - tsconfig, package.json exports\n3. **Check consumers** - Who imports from `@skills-supply/database`\n4. **Migration files** - Ensure migrations aren't affected\n\n## Risk: MEDIUM\n\nDatabase migrations and models need careful handling.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T21:19:47.69217-05:00","created_by":"alizain","updated_at":"2026-01-04T16:24:14.420877-05:00","closed_at":"2026-01-04T16:24:14.420877-05:00","close_reason":"Not needed - only removing src/ from sk, discovery, core, api"}
{"id":"skillssupply-e3w","title":"Manifest discovery","description":"Walk up directory tree from cwd to home. Find all skills.toml files. Always include ~/.sksup/skills.toml as base layer.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:17:33.852618-05:00","created_by":"alizain","updated_at":"2025-12-29T11:00:09.012136-05:00","closed_at":"2025-12-29T11:00:09.012136-05:00","close_reason":"Closed","labels":["core-manifest","sksup"],"dependencies":[{"issue_id":"skillssupply-e3w","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:17:33.853572-05:00","created_by":"daemon"},{"issue_id":"skillssupply-e3w","depends_on_id":"skillssupply-yzr","type":"blocks","created_at":"2025-12-28T21:21:58.943809-05:00","created_by":"daemon"}]}
{"id":"skillssupply-e5x","title":"Use consola for prompts/logging in sksup","description":"Adopt consola for CLI output/logging (info/warn/success/error/start), while keeping @clack/prompts for interactive input (select/multiselect/text/confirm and isCancel). Replace direct clack logging/spinner usage in commands with consola; keep clack prompts where needed.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T15:33:55.576537-05:00","created_by":"alizain","updated_at":"2025-12-31T08:54:54.671047-05:00","closed_at":"2025-12-31T08:54:54.671047-05:00","close_reason":"Already complete - consola@3.4.2 used throughout all command files"}
{"id":"skillssupply-eck","title":"Reduce sparse checkout duplication across monorepo paths","description":"Replace cache-based fetch strategy with per-sync ephemeral clones.\n\n- For each sync run and per agent, create a temp dir and shallow clone each package. Duplicated clones across agents are acceptable for now.\n- Local path packages remain symlink installs (no clone).\n- For pinned revs, attempt shallow fetch; if the commit is missing, fall back to a deeper or full fetch.\n- Remove ~/.cache/sksup/repos usage.\n\nNote: the current sparse-checkout cache implementation should be significantly reworked and mostly removed.\n","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T20:35:45.923248-05:00","created_by":"alizain","updated_at":"2025-12-30T12:02:27.870039-05:00","closed_at":"2025-12-30T12:02:27.870039-05:00","close_reason":"Closed","labels":["core-packages","sksup"],"dependencies":[{"issue_id":"skillssupply-eck","depends_on_id":"skillssupply-cht","type":"discovered-from","created_at":"2025-12-29T20:35:45.925065-05:00","created_by":"alizain"}]}
{"id":"skillssupply-eq7","title":"FrontmatterError uses hardcoded type literal instead of discriminated union","description":"In packages/core/src/frontmatter.ts:17-20, FrontmatterError has type: 'invalid_frontmatter' as a hardcoded literal. Should follow packages/sk pattern of defining a type union (e.g., type FrontmatterErrorType = 'invalid_frontmatter' | 'parse_error') for extensibility and consistency.","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-03T16:52:06.353114-05:00","created_by":"alizain","updated_at":"2026-01-03T16:52:06.353114-05:00"}
{"id":"skillssupply-f2t","title":"sksup pkg add command","description":"Add packages via CLI: sksup pkg add gh owner/repo [--tag|--branch|--rev] [--path] [--as]. Write to ./skills.toml, confirm creation if file doesn't exist.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:18:18.688688-05:00","created_by":"alizain","updated_at":"2025-12-30T12:14:49.663486-05:00","closed_at":"2025-12-30T12:14:49.663486-05:00","close_reason":"Closed","labels":["commands","sksup"],"dependencies":[{"issue_id":"skillssupply-f2t","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:18:18.689737-05:00","created_by":"daemon"},{"issue_id":"skillssupply-f2t","depends_on_id":"skillssupply-5jr","type":"blocks","created_at":"2025-12-28T21:22:46.645515-05:00","created_by":"daemon"},{"issue_id":"skillssupply-f2t","depends_on_id":"skillssupply-rtm","type":"blocks","created_at":"2025-12-28T21:22:46.665954-05:00","created_by":"daemon"}],"comments":[{"id":2,"issue_id":"skillssupply-f2t","author":"alizain","text":"pkg add now routed via sksup pkg add; validated with local path package using pseudo-tty.","created_at":"2025-12-30T17:14:35Z"}]}
{"id":"skillssupply-f7v","title":"Update legacy skills.toml docs to agents.toml","description":"Docs in docs/2025-12-28-* and older CLI plans still reference skills.toml/[packages]; update or archive now that agents.toml is canonical.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T16:43:08.840827-05:00","created_by":"alizain","updated_at":"2025-12-31T14:26:55.764882-05:00"}
{"id":"skillssupply-f9q","title":"sksup pkg interactive mode","description":"Ink-based package browser/manager. Show installed packages, allow add/remove. Triggered by bare 'sksup pkg' command.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:18:19.082325-05:00","created_by":"alizain","updated_at":"2025-12-30T15:12:24.19592-05:00","closed_at":"2025-12-30T15:12:24.19592-05:00","close_reason":"Closed","labels":["commands","sksup"],"dependencies":[{"issue_id":"skillssupply-f9q","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:18:19.083428-05:00","created_by":"daemon"},{"issue_id":"skillssupply-f9q","depends_on_id":"skillssupply-f2t","type":"blocks","created_at":"2025-12-28T21:22:46.705389-05:00","created_by":"daemon"},{"issue_id":"skillssupply-f9q","depends_on_id":"skillssupply-0xc","type":"blocks","created_at":"2025-12-28T21:22:46.725457-05:00","created_by":"daemon"}],"comments":[{"id":5,"issue_id":"skillssupply-f9q","author":"alizain","text":"pkg interactive exists; requires TTY input to validate (multiselect/confirm). Not completed in non-interactive run.","created_at":"2025-12-30T17:16:27Z"},{"id":6,"issue_id":"skillssupply-f9q","author":"alizain","text":"Validated pkg interactive via pseudo-tty: add flow (local path ../pkg, alias demo) and remove flow removed demo from skills.toml.","created_at":"2025-12-30T20:12:11Z"}]}
{"id":"skillssupply-i1u","title":"Investigate: Can discovery's scanRepo reuse core's detectStructure","description":"## Context\nDiscovery's `scanRepo` and core's `detectStructure` have overlapping concerns but serve different purposes:\n\n- **Core's `detectStructure`**: Single-location detection, non-recursive, returns `DetectedStructure[]`\n- **Discovery's `scanRepo`**: Recursive repo scanning, extracts metadata, returns `ScanUnit[]`\n\n## scanRepo Structure (182 lines)\n\nThe function has 4 distinct phases that could potentially be split:\n\n1. **Validate and coerce paths** (lines 57-95) ~40 lines\n2. **Phase 1: Check marketplace.json at root** (lines 99-130) ~30 lines  \n3. **Phase 1: Check manifest at root** (lines 132-167) ~35 lines\n4. **Phase 2: DFS for skills** (lines 173-231) ~60 lines\n\n## Investigation Questions\n1. Can `scanRepo` use `detectStructure` for Phase 1 (root-level detection)?\n2. Can `scanRepo` use `detectStructure` within Phase 2's recursive loop?\n3. What changes would `detectStructure` need to support this?\n4. Is the benefit worth the coupling?\n\n## Current State\n- `scanRepo` (discovery/src/detection/scan.ts) manually checks for marketplace.json, agents.toml, SKILL.md\n- `detectStructure` (core/src/detection/structure.ts) does similar checks but returns different shapes\n- Both use `discoverSkillPathsForSubdir` from core\n\n## Files\n- packages/discovery/src/detection/scan.ts\n- packages/core/src/detection/structure.ts\n- packages/SPEC.md (detection flows)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T11:59:24.900088-05:00","created_by":"alizain","updated_at":"2026-01-04T12:29:58.212824-05:00"}
{"id":"skillssupply-i5y","title":"sk --version flag doesn't exist","status":"in_progress","priority":2,"issue_type":"bug","created_at":"2026-01-02T11:05:57.944212-05:00","created_by":"alizain","updated_at":"2026-01-02T13:15:52.773537-05:00"}
{"id":"skillssupply-ies","title":"Replace custom frontmatter parser with gray-matter","description":"## Overview\n\nReplace the custom YAML-like frontmatter parser in `packages/core/src/frontmatter.ts` (~154 lines) with the battle-tested `gray-matter` library (24M+ weekly downloads).\n\n## Current Implementation\n\n`parseSkillFrontmatter()` in `packages/core/src/frontmatter.ts`:\n- Line-by-line parsing with `indexOf(\":\")`\n- Manual quote stripping (single/double)\n- Duplicate field detection\n- Multiline syntax rejection (`|` and `\u003e`)\n- Windows/mixed line ending handling\n- ~154 lines of custom parsing logic\n- ~472 lines of tests\n\n## Why gray-matter\n\n- Handles full YAML spec (types, arrays, nested objects)\n- Robust parsing via js-yaml under the hood\n- Normalized line ending handling\n- Battle-tested with 24M+ weekly downloads\n- Eliminates risk of edge cases in custom lenient parser\n\n## Migration Notes\n\n- Current parser only extracts `name` and `description` fields\n- gray-matter parses full YAML, so add post-parse validation to:\n  - Reject multiline values (if still desired)\n  - Validate only expected fields\n  - Handle `name:` with no value (gray-matter returns `null`, current returns error)\n\n## Files Affected\n\n- `packages/core/src/frontmatter.ts` - replace implementation\n- `packages/core/src/frontmatter.test.ts` - update tests for new behavior\n- `packages/core/package.json` - add gray-matter dependency\n\n## Estimated Impact\n\n- 154 lines custom parsing → ~30 lines with gray-matter + validation\n- Eliminates custom YAML edge case handling\n- Maintains same Result-type API for consumers","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T21:16:40.083431-05:00","created_by":"alizain","updated_at":"2026-01-03T21:16:40.083431-05:00"}
{"id":"skillssupply-ivd","title":"Rename CLI package from sksup to sk","description":"Rename the CLI package from 'sksup' to 'sk' for a shorter, cleaner command.\n\n## Files to Update\n\n### Package Rename\n- [ ] Rename directory: `packages/sksup` → `packages/sk`\n- [ ] Update `package.json`:\n  - name: `@skills-supply/sksup` → `@skills-supply/sk`\n  - bin: `sksup` → `sk`\n  - bundle script: `--outfile ./bin/sksup` → `--outfile ./bin/sk`\n\n### Codebase References\n- [ ] Grep for 'sksup' across all files and update references\n- [ ] Update any workspace references in root package.json\n- [ ] Update any imports referencing the old package name\n\n### Documentation\n- [ ] Update any README or docs mentioning `sksup` command\n\n### Testing\n- [ ] Verify `sk` command works after rename\n- [ ] Test all subcommands (sync, manifest, pkg, agent)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T16:30:47.703071-05:00","created_by":"alizain","updated_at":"2025-12-31T08:54:54.317891-05:00","closed_at":"2025-12-31T08:54:54.317891-05:00","close_reason":"Already complete - CLI package is @skills-supply/sk with bin 'sk'"}
{"id":"skillssupply-j4k","title":"Remove src/ directory nesting from packages/discovery","description":"## Overview\nFlatten `packages/discovery/src/` → `packages/discovery/`\n\n## Config Changes (YOU do these after IDE moves files)\n\n### tsconfig.json\n- `include`: `[\"src/**/*\"]` → `[\"**/*.ts\"]`\n\n### package.json (5 scripts)\n- `draft`: `src/cli.ts` → `cli.ts`\n- `enqueue`: `src/cli.ts` → `cli.ts`\n- `list`: `src/cli.ts` → `cli.ts`\n- `tsx`: `src/cli.ts` → `cli.ts`\n- `worker`: `src/cli.ts` → `cli.ts`\n\n### vitest.config.ts\n- `include`: `[\"src/**/*.test.ts\"]` → `[\"**/*.test.ts\"]`\n\n## Import Changes (IDE handles)\n10 files with `@/src/*` → `@/*` pattern (28 import statements)\n\n## Files Moving\n- cli.ts, env.ts, types.ts\n- commands/, db/, detection/, queue/, sources/, utils/\n\n## Verification\n- `npm run biome` passes\n- `npm test` in packages/discovery passes\n- `npm run build` from root passes","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-03T21:19:47.424007-05:00","created_by":"alizain","updated_at":"2026-01-04T16:31:01.487552-05:00"}
{"id":"skillssupply-jcy","title":"Local path package handling","description":"Resolve relative paths from skills.toml source directory. Validate path exists. Convert to absolute path in canonical form.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:17:53.279849-05:00","created_by":"alizain","updated_at":"2025-12-29T19:38:35.140343-05:00","closed_at":"2025-12-29T19:38:35.140343-05:00","close_reason":"Closed","labels":["core-packages","sksup"],"dependencies":[{"issue_id":"skillssupply-jcy","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:17:53.280934-05:00","created_by":"daemon"},{"issue_id":"skillssupply-jcy","depends_on_id":"skillssupply-yzr","type":"blocks","created_at":"2025-12-28T21:22:05.915513-05:00","created_by":"daemon"}]}
{"id":"skillssupply-jwc","title":"Fix: selectDetectedStructure doesn't handle plugin+marketplace case per SPEC","description":"## Problem\nSPEC.md defines Priority 2 for sk add detection:\n\n\u003e **Priority 2: plugin.json + marketplace.json both exist**\n\u003e - Check if plugin belongs to marketplace\n\u003e - Case A: Plugin belongs → add as claude-plugin\n\u003e - Case B: Plugin doesn't belong → prompt user\n\nBut `selectDetectedStructure` in sync.ts:583-626 doesn't explicitly handle this case.\nIt falls through to plugin detection, which may not be correct per SPEC.\n\n## Current Code (sync.ts)\n```typescript\nasync function selectDetectedStructure(...) {\n  const plugin = structures.find((entry) =\u003e entry.method === \"plugin\")\n  const manifest = structures.find((entry) =\u003e entry.method === \"manifest\")\n  // ... \n\n  if (manifest) { /* check for package section */ }\n  if (plugin) { return plugin }  // ← Doesn't check if marketplace also exists\n  if (subdir) { ... }\n  if (single) { ... }\n  if (marketplace) { return error }\n}\n```\n\n## Expected Behavior\nWhen both plugin AND marketplace exist:\n1. Load plugin.json to get plugin name\n2. Load marketplace.json to get plugin list\n3. If plugin name is in marketplace → this IS a claude-plugin package\n4. If not → prompt user or error (depends on context)\n\n## Files\n- packages/sk/src/core/sync/sync.ts (selectDetectedStructure)\n- packages/sk/src/core/packages/auto-detect.ts (resolveDetection - already handles this!)\n- packages/SPEC.md (Priority 2 definition)\n\n## Note\nauto-detect.ts DOES handle this correctly (lines 343-378). The fix may be to align sync.ts with auto-detect.ts logic.","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-04T11:59:25.441879-05:00","created_by":"alizain","updated_at":"2026-01-04T11:59:25.441879-05:00"}
{"id":"skillssupply-ksl","title":"Unit tests: manifest/parse.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T20:14:08.38936-05:00","created_by":"alizain","updated_at":"2025-12-30T20:45:16.792453-05:00","closed_at":"2025-12-30T20:45:16.792453-05:00","close_reason":"Closed","dependencies":[{"issue_id":"skillssupply-ksl","depends_on_id":"skillssupply-a3i","type":"blocks","created_at":"2025-12-30T20:14:26.399378-05:00","created_by":"daemon"}]}
{"id":"skillssupply-l2q","title":"Create packages/database + docker-compose + initial migrations","description":"Copy toastandchill database + related files into packages/database; adapt imports; add docker-compose.yaml at repo root; define initial migrations for users/tokens/cli_auth_sessions/repo_state/plugins/purchases as needed by API + web.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T10:14:15.744229-05:00","updated_at":"2025-12-19T13:44:50.189102-05:00","closed_at":"2025-12-19T13:44:50.189102-05:00","close_reason":"Closed via update","dependencies":[{"issue_id":"skillssupply-l2q","depends_on_id":"skillssupply-yf2","type":"parent-child","created_at":"2025-12-19T10:14:39.963884-05:00","created_by":"daemon"}]}
{"id":"skillssupply-llt","title":"Switch to bun-only build (drop tsc emit)","description":"**Decision:** Just bun it.\n\n**New build flow:**\n- `tsc` → type checking only (`noEmit: true`)\n- `bun build ./src/cli.ts --compile` → binary distribution\n- `bun build ./src/cli.ts --outdir ./dist --target node` → npm distribution\n\nBun resolves @/ aliases natively. No need for tsc-alias, tsdown, or esbuild.\n\n**Changes needed:**\n1. Set `noEmit: true` in tsconfig.json\n2. Update package.json scripts to use bun build directly from src/\n3. Remove tsc from build pipeline (keep for `npm run check`)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T10:53:03.939368-05:00","created_by":"alizain","updated_at":"2025-12-30T08:35:25.295347-05:00","closed_at":"2025-12-30T08:35:25.295347-05:00","close_reason":"Switched sksup build to bun-only with noEmit typecheck.","labels":["build","sksup"],"dependencies":[{"issue_id":"skillssupply-llt","depends_on_id":"skillssupply-5jr","type":"discovered-from","created_at":"2025-12-29T10:53:03.941764-05:00","created_by":"alizain"}]}
{"id":"skillssupply-n2f","title":"Git URL package fetching","description":"Clone arbitrary git URLs. Handle HTTPS and SSH protocols. Support --tag, --branch, --rev, --path options.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:17:53.084826-05:00","created_by":"alizain","updated_at":"2025-12-29T19:37:25.628268-05:00","closed_at":"2025-12-29T19:37:25.628268-05:00","close_reason":"Closed","labels":["core-packages","sksup"],"dependencies":[{"issue_id":"skillssupply-n2f","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:17:53.085951-05:00","created_by":"daemon"},{"issue_id":"skillssupply-n2f","depends_on_id":"skillssupply-yzr","type":"blocks","created_at":"2025-12-28T21:22:05.895978-05:00","created_by":"daemon"}]}
{"id":"skillssupply-nkt","title":"agents.toml exports schema + extraction","description":"Define agents.toml package schema (exports.auto_discover.skills) and implement extraction to enumerate skills from manifest.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T20:08:25.130239-05:00","created_by":"alizain","updated_at":"2025-12-31T14:35:42.158933-05:00","closed_at":"2025-12-31T14:35:42.158933-05:00","close_reason":"Implemented during agents.toml migration - exports.auto_discover.skills schema and extractFromManifest() extraction exist","labels":["core-packages","sksup"],"dependencies":[{"issue_id":"skillssupply-nkt","depends_on_id":"skillssupply-98v","type":"discovered-from","created_at":"2025-12-29T20:08:25.131965-05:00","created_by":"alizain"}]}
{"id":"skillssupply-ntq","title":"Track web (Next.js) data-model needs for creator/end-user flows","description":"Define data models for web app: users (id/email/username), creator profiles (payout/Stripe Connect status), plugins (slug/name/description/preview/price/is_active/source repo connection), purchases/entitlements (status/paid_at/refund), API tokens + devices, CLI auth sessions, marketplace listings, and analytics/usage events. Keep in sync with API/db schema decisions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T10:14:30.817009-05:00","updated_at":"2025-12-31T08:54:55.244534-05:00","closed_at":"2025-12-31T08:54:55.244534-05:00","close_reason":"Core schema implemented in packages/database - users, plugins, api_tokens, cli_auth_sessions, purchases, repo_state tables exist","dependencies":[{"issue_id":"skillssupply-ntq","depends_on_id":"skillssupply-yf2","type":"parent-child","created_at":"2025-12-19T10:14:54.300407-05:00","created_by":"daemon"}]}
{"id":"skillssupply-o55","title":"Unit tests: manifest/coerce.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T20:14:08.585743-05:00","created_by":"alizain","updated_at":"2025-12-30T20:45:16.794275-05:00","closed_at":"2025-12-30T20:45:16.794275-05:00","close_reason":"Closed","dependencies":[{"issue_id":"skillssupply-o55","depends_on_id":"skillssupply-a3i","type":"blocks","created_at":"2025-12-30T20:14:26.597447-05:00","created_by":"daemon"}]}
{"id":"skillssupply-omg","title":"Confirm API env var conventions (PUBLIC_BASE_URL, WEB_BASE_URL, REPO_CACHE_DIR, TTL)","description":"Decide naming/values for API env vars and defaults; update packages/api/src/env.ts and docs accordingly.","design":"**Decision: API env var conventions**\n\n**Base URLs:**\n- `API_BASE_URL` — public-facing API URL (e.g., `https://api.skills.supply`)\n- `WEB_BASE_URL` — web app URL for redirects (e.g., `https://skills.supply`)\n\n**Repo caching:**\n- `REPO_CACHE_DIR` — directory for cloned repos\n- `REPO_CACHE_TTL` — how long cached repos stay valid\n\n**Auth TTLs:**\n- `CLI_AUTH_SESSION_TTL` — browser auth session expiry (10 min)\n- `API_TOKEN_TTL` — token expiry duration (6-8 weeks)\n\n**Naming convention:**\n- Group related vars with shared prefix: `REPO_CACHE_*`, `CLI_AUTH_*`, `API_*`\n- TTLs are always `{GROUP}_{THING}_TTL` or `{THING}_TTL`\n- Makes it obvious what belongs together","notes":"Decided 2025-12-19: Use grouped prefixes (REPO_CACHE_*, CLI_AUTH_*, etc.) for clarity.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T12:08:58.389036-05:00","updated_at":"2025-12-19T12:56:13.051727-05:00","closed_at":"2025-12-19T12:56:13.051727-05:00","close_reason":"Decision made: API_BASE_URL, WEB_BASE_URL, grouped prefixes for TTLs (REPO_CACHE_TTL, CLI_AUTH_SESSION_TTL, etc.)","dependencies":[{"issue_id":"skillssupply-omg","depends_on_id":"skillssupply-19a","type":"discovered-from","created_at":"2025-12-19T12:09:03.238443-05:00","created_by":"daemon"}]}
{"id":"skillssupply-otj","title":"Define purchased plugin source integration (repo_url/source_repo_path)","description":"Decide how purchased plugin content is sourced and served (local mirror path vs remote clone, credentials for private GitHub, update strategy). Update plugin schema + API repo resolver accordingly.","design":"**Decision: Clone-on-demand from seller's repo**\n\n- When buyer requests a purchased plugin, we clone from seller's source repo on-demand\n- Serve from local clone, no long-term caching for now (add later if needed)\n- Seller provides access via GitHub OAuth token or deploy key\n- Buyer authenticates with Skills Supply API token only - no GitHub OAuth needed for buyers\n\n**Data model:**\n- `plugins.source_repo_url` - seller's GitHub repo\n- `plugins.source_ref` - branch/tag to clone\n- Clone stored temporarily in `REPO_CACHE_DIR`","notes":"Decided 2025-12-19: Keep simple with on-demand cloning. Add caching layer later when needed.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T11:59:39.885501-05:00","updated_at":"2025-12-19T12:41:31.950446-05:00","closed_at":"2025-12-19T12:41:31.950446-05:00","close_reason":"Decision made: clone-on-demand from seller's GitHub, short TTL cache, no buyer OAuth needed","dependencies":[{"issue_id":"skillssupply-otj","depends_on_id":"skillssupply-19a","type":"discovered-from","created_at":"2025-12-19T11:59:47.836228-05:00","created_by":"daemon"}]}
{"id":"skillssupply-p67","title":"Remove src/ directory nesting from all packages","description":"## Overview\n\nFlatten package structure by removing the unnecessary `src/` directory layer. Files should live directly in the package root.\n\n**Current**: `packages/sk/src/core/types/coerce.ts`\n**Target**: `packages/sk/core/types/coerce.ts`\n\n## Packages Affected\n\n- `packages/sk/src/` → `packages/sk/`\n- `packages/discovery/src/` → `packages/discovery/`\n- `packages/core/src/` → `packages/core/`\n- `packages/database/` (check if applicable)\n- `packages/web/` (check if applicable - Next.js may have conventions)\n\n## Pre-Work: Understand Implications (REQUIRED)\n\n**Before making any changes**, use subagents to fully audit each package for:\n\n1. **Build configuration**\n   - `tsconfig.json` - rootDir, outDir, include/exclude paths\n   - `package.json` - exports, main, types, files fields\n   - Any build scripts referencing `src/`\n\n2. **Import paths**\n   - Internal imports within the package\n   - Cross-package imports (`@skills-supply/core`, etc.)\n   - Test file imports\n\n3. **Tool configuration**\n   - Biome/ESLint config paths\n   - Vitest config paths\n   - TypeScript project references\n\n4. **CI/CD \u0026 Scripts**\n   - GitHub Actions referencing paths\n   - npm scripts with hardcoded paths\n   - Any shell scripts\n\n5. **Editor/IDE**\n   - VS Code settings referencing paths\n   - Launch configurations\n\n## Approach\n\nFor each package:\n1. Launch subagent to audit all path references and dependencies\n2. Document all files/configs that need updating\n3. Make the move atomically (all changes in one commit per package)\n4. Run full test suite to verify\n5. Update any documentation\n\n## Risk Assessment\n\n- **Low risk**: `core` (small, few consumers)\n- **Medium risk**: `sk` (CLI entry point, published package)\n- **Medium risk**: `discovery` (build scripts, worker processes)\n- **Higher risk**: `web` (Next.js conventions may conflict)\n\n## Why This Matters\n\n- Reduces cognitive overhead navigating codebase\n- Shorter import paths\n- Aligns with modern flat package conventions\n- One less directory to click through in every package","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T21:18:33.465022-05:00","created_by":"alizain","updated_at":"2026-01-03T21:19:53.075452-05:00","closed_at":"2026-01-03T21:19:53.075452-05:00","close_reason":"Superseded by individual per-package beads"}
{"id":"skillssupply-pw4","title":"Remove src/ directory nesting from packages/web","description":"## Overview\n\nAudit `packages/web/` for src/ flattening opportunity.\n\n## Pre-Work: Understand Implications (REQUIRED)\n\n**Before making any changes**, use subagents to:\n\n1. **Check Next.js conventions** - Next.js may require specific directory structure\n2. **Audit app/ vs src/ structure** - Modern Next.js uses `app/` router\n3. **Verify if change is even desirable** - Framework conventions may override preference\n\n## Risk: HIGHER\n\nNext.js has strong conventions about directory structure. May not be worth changing.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T21:19:47.9675-05:00","created_by":"alizain","updated_at":"2026-01-04T16:24:14.418425-05:00","closed_at":"2026-01-04T16:24:14.418425-05:00","close_reason":"Not needed - only removing src/ from sk, discovery, core, api"}
{"id":"skillssupply-pzy","title":"GitHub package fetching","description":"Clone GitHub repos via git. Handle --tag, --branch, --rev refs. Support sparse checkout for --path (monorepo subdirectory).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:17:52.837835-05:00","created_by":"alizain","updated_at":"2025-12-29T19:35:32.529467-05:00","closed_at":"2025-12-29T19:35:32.529467-05:00","close_reason":"Closed","labels":["core-packages","sksup"],"dependencies":[{"issue_id":"skillssupply-pzy","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:17:52.839452-05:00","created_by":"daemon"},{"issue_id":"skillssupply-pzy","depends_on_id":"skillssupply-yzr","type":"blocks","created_at":"2025-12-28T21:22:05.875255-05:00","created_by":"daemon"}]}
{"id":"skillssupply-qdl","title":"Extract loadAndParse helper in auto-detect.ts","description":"## Context\n\nIn `packages/sk/src/core/packages/auto-detect.ts`, three functions follow identical patterns:\n\n- `loadMarketplaceManifest()` (lines 427-446)\n- `loadPluginName()` (lines 449-463)  \n- `loadManifestInfo()` (lines 480-494)\n\nAll do: read file → parse → return result or error.\n\n## Task\n\nExtract a generic helper:\n\n```typescript\nasync function loadAndParse\u003cT\u003e(\n  path: AbsolutePath,\n  parser: (content: string) =\u003e { ok: boolean; value?: T; error?: { message: string } }\n): Promise\u003c{ ok: true; value: T } | { ok: false; error: string }\u003e\n```\n\nReplace the three functions with calls to this helper.\n\n## Files\n- packages/sk/src/core/packages/auto-detect.ts","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-04T12:28:14.462884-05:00","created_by":"alizain","updated_at":"2026-01-04T12:28:14.462884-05:00"}
{"id":"skillssupply-qz1","title":"Decide CLI auth completion handshake + token format","description":"Confirm /auth/cli completion mechanism (endpoint + auth), session TTL, and API token format/prefix. Align API + sksup behavior accordingly.","design":"**Partial decision: Session TTL + Token expiry**\n\n**Browser auth session TTL:**\n- Session expires after 10 minutes if not completed\n- Forces user to run `sksup auth` again if they wait too long\n\n**Token expiry:**\n- See skillssupply-zfe for token format and expiry details\n\n**CLI auth handshake:**\n- Carved out to separate issue (skillssupply-xxx) for security review\n- Initial thinking: POST /auth/cli → session_id, poll /auth/cli/status\n- Needs security review before finalizing","notes":"Decided 2025-12-19: 10 min session TTL. CLI auth handshake carved out for separate security review.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T12:00:05.05884-05:00","updated_at":"2025-12-19T12:53:44.271866-05:00","closed_at":"2025-12-19T12:53:44.271866-05:00","close_reason":"Session TTL decided (10 min). CLI auth handshake carved out to skillssupply-642 for security review.","dependencies":[{"issue_id":"skillssupply-qz1","depends_on_id":"skillssupply-19a","type":"discovered-from","created_at":"2025-12-19T12:00:12.06897-05:00","created_by":"daemon"}]}
{"id":"skillssupply-rgg","title":"Handle Claude plugins with strict=false","description":"Claude marketplace.json supports plugins with strict=false (plugin.json optional). Decide whether sksup should allow extraction without .claude-plugin/plugin.json or continue to hard-error, and document behavior.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T16:44:57.468282-05:00","created_by":"alizain","updated_at":"2025-12-30T16:44:57.468282-05:00"}
{"id":"skillssupply-rtm","title":"Package resolution to canonical form","description":"Convert PackageDeclaration to CanonicalPackage. Compute dedupe keys for each type. Handle alias derivation (repo name or explicit --as).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:17:34.241911-05:00","created_by":"alizain","updated_at":"2025-12-29T11:04:40.115822-05:00","closed_at":"2025-12-29T11:04:40.115822-05:00","close_reason":"Closed","labels":["core-packages","sksup"],"dependencies":[{"issue_id":"skillssupply-rtm","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:17:34.242896-05:00","created_by":"daemon"},{"issue_id":"skillssupply-rtm","depends_on_id":"skillssupply-yzr","type":"blocks","created_at":"2025-12-28T21:22:05.854526-05:00","created_by":"daemon"}]}
{"id":"skillssupply-sif","title":"Add skill.mdx support for Factory compatibility","description":"Factory supports both SKILL.md and skill.mdx for skill definitions. Currently sk only looks for SKILL.md in detect.ts. Add support for skill.mdx as an alternative skill file format to improve Factory compatibility.\n\nFiles to update:\n- packages/sk/src/core/packages/detect.ts (SKILL_FILENAME constant, discoverSkillPaths function)\n- packages/sk/src/core/packages/extract.ts (if skill file reading needs updates)\n\nReference: https://docs.factory.ai/cli/configuration/skills","status":"open","priority":3,"issue_type":"feature","created_at":"2026-01-02T16:19:41.760508-05:00","created_by":"alizain","updated_at":"2026-01-02T16:19:51.00743-05:00"}
{"id":"skillssupply-tc3","title":"Clean up sk manifest IO + remove dead code","description":"Context\n- `packages/sk/src/commands/manifest.ts` is manifest IO, not a CLI command; it should live under `core/manifest`.\n- `loadManifestForUpdate` is duplicated in `packages/sk/src/commands/pkg/add.ts`, `packages/sk/src/commands/pkg/index.ts`, and `packages/sk/src/commands/agent/index.ts`.\n- There are unused exports and an empty `packages/sk/src/ui` directory.\n\nPlan\n1) Move manifest IO (`loadManifestFromCwd`, `saveManifest`, `ManifestNotFoundError`, `isManifestNotFoundError`, `ManifestLoadResult`) to a core module (suggested: `packages/sk/src/core/manifest/fs.ts` or `packages/sk/src/core/manifest/io.ts`).\n2) Create a command-layer helper that owns the \"create agents.toml?\" prompt and reuse it across pkg/agent commands (one implementation, three callers).\n3) Update imports to new core path and new prompt helper.\n4) Remove dead exports:\n   - `packages/sk/src/core/io/temp.ts` (if unused)\n   - `packages/sk/src/core/packages/fetch.ts` unused `fetchGithubPackage` / `fetchGitPackage`\n   - `packages/sk/src/core/agents/install.ts` unused `installPackagesForAgent` / `buildInstalledSkills`\n   - Delete empty `packages/sk/src/ui` directory\n   (Confirm no references with `rg`.)\n5) Run `npm biome` in repo root after changes.\n\nAcceptance\n- Manifest IO lives under `core/manifest/*`; no `commands/manifest.ts` IO helpers remain.\n- Only one `loadManifestForUpdate`-style prompt helper exists and is reused.\n- No unused exports/directories remain per `rg`.\n- `npm biome` passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T18:06:36.110845-05:00","created_by":"alizain","updated_at":"2025-12-31T14:34:33.013493-05:00","closed_at":"2025-12-30T18:21:05.943102-05:00","close_reason":"Closed"}
{"id":"skillssupply-tml","title":"Fix TypeScript errors in packages/sk","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-30T23:46:52.653324-05:00","created_by":"alizain","updated_at":"2025-12-31T08:54:54.128112-05:00","closed_at":"2025-12-31T08:54:54.128112-05:00","close_reason":"All TypeScript errors fixed - tsc --noEmit passes clean, 375 tests pass"}
{"id":"skillssupply-tql","title":"Consolidate duplicated I/O helpers with fs-extra or core module","description":"## Context\nFour packages implement similar I/O helpers:\n\n| Pattern | Core (structure.ts) | Core (paths.ts) | Discovery (scan.ts) | sk (io/fs.ts) |\n|---------|---------------------|-----------------|---------------------|---------------|\n| safeStat | ✅ lines 259-276 | ✅ lines 132-149 | ✅ lines 492-515 | ✅ lines 12-23 |\n| isNotFound | ✅ lines 278-285 | ✅ lines 151-157 | ✅ lines 517-524 | ✅ lines 100-106 |\n| readDirEntries | ✅ lines 199-213 | ✅ lines 96-110 | ✅ lines 473-489 | ❌ |\n| readFileText | ❌ | ❌ | ✅ lines 441-455 | ✅ lines 68-70 |\n| formatErrorMessage | ✅ lines 287-293 | ✅ lines 160-166 | ❌ | ❌ |\n\n**Note:** Even within core, structure.ts and paths.ts duplicate these helpers.\n\n## Options\n1. **Use fs-extra** - Replace custom helpers with battle-tested library\n2. **Export from core** - Create `@skills-supply/core/io` with shared helpers\n3. **Keep as-is** - Accept ~60 lines duplication (low impact)\n\n## Considerations\n- Each package has slightly different error shapes (CoreError vs ScanWarning vs IoError)\n- Implementations are trivial (~10 lines each)\n- fs-extra adds a dependency but is well-maintained\n- Within-core duplication (structure.ts vs paths.ts) should be fixed regardless\n\n## Files\n- packages/core/src/detection/structure.ts\n- packages/core/src/discovery/paths.ts\n- packages/discovery/src/detection/scan.ts\n- packages/sk/src/core/io/fs.ts","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-04T11:59:25.176102-05:00","created_by":"alizain","updated_at":"2026-01-04T12:16:30.363416-05:00","dependencies":[{"issue_id":"skillssupply-tql","depends_on_id":"skillssupply-i1u","type":"blocks","created_at":"2026-01-04T11:59:36.316321-05:00","created_by":"alizain"}]}
{"id":"skillssupply-vsp","title":"Manifest merging with priority rules","description":"Merge multiple manifests with priority (closest wins). Handle dedupe by canonical keys. Error on alias conflicts (same alias, different packages).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:17:34.044663-05:00","created_by":"alizain","updated_at":"2025-12-29T19:58:16.112608-05:00","closed_at":"2025-12-29T19:58:16.112608-05:00","close_reason":"Implemented manifest merge with priority + dedupe.","labels":["core-manifest","sksup"],"dependencies":[{"issue_id":"skillssupply-vsp","depends_on_id":"skillssupply-yzr","type":"discovered-from","created_at":"2025-12-28T21:17:34.045736-05:00","created_by":"daemon"},{"issue_id":"skillssupply-vsp","depends_on_id":"skillssupply-5jr","type":"blocks","created_at":"2025-12-28T21:21:58.970042-05:00","created_by":"daemon"},{"issue_id":"skillssupply-vsp","depends_on_id":"skillssupply-e3w","type":"blocks","created_at":"2025-12-28T21:21:58.989755-05:00","created_by":"daemon"}]}
{"id":"skillssupply-w8h","title":"E2E tests: sync flows","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-30T20:14:10.192897-05:00","created_by":"alizain","updated_at":"2025-12-30T20:59:18.143209-05:00","closed_at":"2025-12-30T20:59:18.143209-05:00","close_reason":"Closed","dependencies":[{"issue_id":"skillssupply-w8h","depends_on_id":"skillssupply-6xi","type":"blocks","created_at":"2025-12-30T20:14:27.942481-05:00","created_by":"daemon"},{"issue_id":"skillssupply-w8h","depends_on_id":"skillssupply-2a9","type":"blocks","created_at":"2025-12-30T20:14:27.959366-05:00","created_by":"daemon"},{"issue_id":"skillssupply-w8h","depends_on_id":"skillssupply-28w","type":"blocks","created_at":"2025-12-30T20:14:27.977659-05:00","created_by":"daemon"}]}
{"id":"skillssupply-wy2","title":"Implement sksup CLI commands + credential helper flow","description":"Create packages/sksup (@skills-supply/sksup) CLI with auth/status/logout/whoami; browser auth, polling, git credential helper config and storage; no distribution scripts yet.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T10:14:25.895604-05:00","updated_at":"2025-12-19T13:45:04.322472-05:00","closed_at":"2025-12-19T13:45:04.322472-05:00","close_reason":"Closed via update","dependencies":[{"issue_id":"skillssupply-wy2","depends_on_id":"skillssupply-yf2","type":"parent-child","created_at":"2025-12-19T10:14:49.686985-05:00","created_by":"daemon"}]}
{"id":"skillssupply-y6c","title":"Consolidate validation with Zod across all packages","description":"## Overview\n\nRe-audit the codebase for all opportunities to use Zod for validation, then consolidate ~860 lines of manual validation into declarative schemas.\n\nZod is already a dependency in `discovery` (for env.ts). This work adds it to `sk` and `core`.\n\n## Quick Win: formatZodError duplication\n\nIdentical function in 4 core files (~28 lines total):\n- `core/parsing/frontmatter.ts:84-88`\n- `core/parsing/marketplace.ts:97-101`\n- `core/parsing/plugin.ts:63-67`\n- `core/validation/declaration.ts:381-385`\n\nExtract to `core/utils/zod.ts`.\n\n## Quick Win: Schema duplication\n\nNonEmptyStringSchema repeated in 4 files:\n- `core/parsing/frontmatter.ts:7-16`\n- `core/parsing/marketplace.ts:6-12`\n- `core/parsing/plugin.ts:6-12`\n- `core/validation/declaration.ts:13`\n\nExtract to `core/schemas/common.ts`.\n\n## Scope\n\n### packages/sk (~700 lines)\n- **Branded type coercion** (`core/types/coerce.ts`): 10 coerce/is functions → Zod schemas\n- **Dependency declarations** (`core/manifest/coerce.ts`): 4 type guards + 4 coercion functions → `z.discriminatedUnion()`\n- **Registry string parsing** (`core/manifest/coerce.ts`): regex extraction → `z.union().transform()`\n- **JSON parsing** (`core/marketplace/parse.ts`, `core/agents/state.ts`): manual type guards → schemas\n- **Error detection** (7 files): deduplicate `isNotFound()`, `isRecord()` into shared utilities\n\n### packages/discovery (~100 lines)\n- **API responses** (`sources/github.ts`, `sources/skillsmp.ts`): manual field checks → response schemas\n- **Job payloads** (`commands/worker.ts`): queue payload validation\n- **CLI arguments** (`cli.ts`): number coercion with `Number.isFinite` checks\n- **Declaration parsing** (`commands/draft.ts`): discriminated union for 4 declaration types\n\n### packages/core (~64 lines)\n- **Package validation** (`validation.ts`): `validatePackageSection()`, `validateNonEmpty()` → schema\n- **Skill name validation** (`validation.ts`): `validateSkillName()` → schema\n- **Frontmatter validation** (`frontmatter.ts`): embedded validation checks\n\n## Key Patterns to Replace\n\n| Pattern | Occurrences | Zod Solution |\n|---------|-------------|--------------|\n| `typeof x === \"string\"` | 30+ | `z.string()` |\n| `Number.isFinite/isInteger` | 15+ | `z.number().int()` |\n| `Array.isArray()` + loops | 8+ | `z.array(schema)` |\n| Non-empty string checks | 20+ | `z.string().trim().min(1)` |\n| `isRecord()` duplication | 7 | `z.record(z.unknown())` |\n| `isNotFound()` duplication | 7 | shared utility |\n| Discriminated unions | 5 | `z.discriminatedUnion()` |\n| formatZodError duplication | 4 | shared utility |\n| NonEmptyStringSchema duplication | 4 | shared schema |\n\n## Approach\n\n1. Re-audit codebase to confirm/update opportunity list\n2. Add Zod to `sk` and `core` packages\n3. Create shared validation utilities in `core`\n4. Migrate high-impact files first (coerce.ts, parse.ts)\n5. Update tests to use schema-based validation","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T21:16:03.120026-05:00","created_by":"alizain","updated_at":"2026-01-04T12:17:21.236185-05:00"}
{"id":"skillssupply-yf2","title":"Implement Hono git server + sksup CLI packages (v3 design)","description":"Build API package for git HTTP smart protocol + auth endpoints and CLI package for auth/credential setup/install flow. Track ExecPlan + web data-model needs.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-19T10:06:33.574595-05:00","updated_at":"2025-12-19T13:45:09.167641-05:00","closed_at":"2025-12-19T13:45:09.167641-05:00","close_reason":"Closed via update"}
{"id":"skillssupply-yzr","title":"Restructure sksup for cac + ink","description":"Add cac, ink, react, smol-toml dependencies. Set up cac command routing in cli.ts. Convert existing auth commands to use ink for output.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T21:17:15.91467-05:00","created_by":"alizain","updated_at":"2025-12-28T21:39:52.088637-05:00","closed_at":"2025-12-28T21:39:52.088637-05:00","close_reason":"Closed","labels":["infrastructure","sksup"]}
{"id":"skillssupply-zfe","title":"Decide API token format + Basic username validation behavior","description":"Confirm token format/prefixing (e.g., ss_live_) and whether Basic auth should require username match. Update API auth + CLI handling accordingly.","design":"**Decision: Token format + Basic auth validation**\n\n**Token format:**\n- `ss_prod_xxx` for production\n- `ss_stg_xxx` for staging\n- Environment prefix makes it clear which environment a token belongs to\n\n**Basic auth validation:**\n- Username = user_id\n- Password = token\n- Backend MUST validate BOTH match (not just token)\n- Prevents token reuse if leaked without user_id\n\n**Token expiry:**\n- Tokens expire after 6-8 weeks (exact duration stored in code as constant)\n- `tokens.created_at` stored in database\n- Allows dynamic expiry adjustment without migration\n- On auth, check: `now - created_at \u003c TOKEN_TTL`","notes":"Decided 2025-12-19: ss_prod_/ss_stg_ prefix, validate both username+token, 6-8 week expiry with created_at in DB.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T12:08:50.335515-05:00","updated_at":"2025-12-19T12:53:44.223449-05:00","closed_at":"2025-12-19T12:53:44.223449-05:00","close_reason":"Decision made: ss_prod_/ss_stg_ prefix, validate both username+token, 6-8 week expiry","dependencies":[{"issue_id":"skillssupply-zfe","depends_on_id":"skillssupply-19a","type":"discovered-from","created_at":"2025-12-19T12:08:54.083279-05:00","created_by":"daemon"}]}
